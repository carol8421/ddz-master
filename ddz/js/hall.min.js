Date.prototype.Format=function(a){var c={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};if(/(y+)/.test(a)){a=a.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))}for(var b in c){if(new RegExp("("+b+")").test(a)){a=a.replace(RegExp.$1,(RegExp.$1.length==1)?(c[b]):(("00"+c[b]).substr((""+c[b]).length)))}}return a};var websiteHost=window.location.hostname;var isDist=websiteHost.match(/web.ddz.dasheng.tv/);var isPreDist=websiteHost.match(/123.207.77.220/);var mainUrl=isDist?"https://api.ddz.dasheng.tv":isPreDist?"https://api.ddz.dasheng.tv:4429":"http://123.207.77.220:9001";var appKey=isDist||isPreDist?"p5tvi9dstt364":"4z3hlwrv4zv0t";var hostUrl=isDist||isPreDist?"https://api.dasheng.tv:4431":"https://api.ttt.dasheng.tv:4433";var ddzUrl={home:"/ddz/home",info:"/ddz/info",watch:"/v1/ddz-home/add-watch-num"};var pkApiUrl={init:"/v1/activity/ddz/init-page",vote:"/v1/ddz-home/like-pk-video",getGift:"/v1/ddz-home/receive-pk-video-gift"};var signApiUrl={getJsUrl:"/v2/user/auth/get-js-url",getMsg:"/v2/user/auth/captcha",login:"/v1/ddz-home/get-token",getInfo:"/v1/ddz-home/init-page",sign:"/v1/ddz-home/sign-prize"};var v={};var CommonJS={GetQueryString:function(a){var b=new RegExp("(^|&)"+a+"=([^&]*)(&|$)","i");var c=window.location.search.substr(1).match(b);if(c!=null){return c[2]}return false},CreateScript:function(a,c){var b=document.createElement("script");b.src=a;if(b.readyState){b.onreadystatechange=function(){if(b.readyState=="loaded"||b.readyState=="complete"){b.onreadystatechange=null;if(c){c()}}}}else{b.onload=function(){if(c){c()}}}document.getElementsByTagName("body").item(0).appendChild(b)},RemoveProtocol:function(a){if(a!=null&&a!=""){return a.replace("https:","").replace("http:","")}return a},RemoveObjByClass:function(a){if(a.length!=undefined){for(i in a){if(document.getElementsByClassName(a[i])[0]){document.getElementsByClassName(a[i])[0].parentNode.removeChild(document.getElementsByClassName(a[i])[0])}}}else{if(document.getElementsByClassName(a)[0]){document.getElementsByClassName(a)[0].parentNode.removeChild(document.getElementsByClassName(a)[0])}}},ImageCompression:function(d,b,a,e,c){e=e?e:80;c=c?c:"jpg";if(d.indexOf("dasheng.tv")>0){return d.replace("file","img")+"?imageView2/1/w/"+b+"/h/"+a+"/"+c+"/"+e}return d},Toast:function(d,b,e){var c;if(document.getElementById("toast")!=null){c=document.getElementById("toast")}else{c=document.createElement("div");c.id="toast";document.getElementsByTagName("body")[0].appendChild(c)}c.innerHTML=d;currentTimes=0;totalTimes=b?b:1300;if(!c.className.match(new RegExp("(\\s|^)show(\\s|$)"))){c.className="show";var a=setInterval(function(){currentTimes+=33;if(currentTimes>=totalTimes){clearInterval(a);c.classList.remove("show");e?e():""}},33)}},AppendStr:function(c,b){var a=c.split("");if(a[a.length-1]=="/"){return c+b}else{return c+"/"+b}},WhichTransitionEvent:function(c){var b=document.createElement("fakeelement");var d=c==="animation"?{WebkitTransition:"webkitAnimationEnd",MozTransition:"animationend",OTransition:"oAnimationEnd oAnimationend",transition:"animationend"}:{WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd oTransitionend",transition:"transitionend"};for(var a in d){if(b.style[a]!==undefined){return d[a]}}},ScreenWidth:function(){return window.screen.width},ScreenHeight:function(){return window.screen.height},SetStyle:function(b,a){for(i in a){b.style[i]=a[i]}},Copy:function(c,a){var b=function(d){d.clipboardData.setData("text/plain",c);d.preventDefault()};document.addEventListener("copy",b);document.execCommand("copy");document.removeEventListener("copy",b);if(a){a()}else{CommonJS.Toast("复制成功")}},GetRequest:function(){var b=location.search;var a=new Object();if(b.indexOf("?")!=-1){var d=b.substr(1);strs=d.split("&");for(var c=0;c<strs.length;c++){a[strs[c].split("=")[0]]=(strs[c].split("=")[1])}}return a},getUinItem:function(a){if(a.indexOf("o")==0){return parseInt(a.replace("o",""))}else{return parseInt(a)}},setCookie:function(b,c,a){var d=new Date();d.setDate(d.getDate()+a);document.cookie=b+"="+escape(c)+((a==null)?"":"; expires="+d.toGMTString())},getCookie:function(a){if(document.cookie.length>0){c_start=document.cookie.indexOf(a+"=");if(c_start!=-1){c_start=c_start+a.length+1;c_end=document.cookie.indexOf(";",c_start);if(c_end==-1){c_end=document.cookie.length}return unescape(document.cookie.substring(c_start,c_end))}}return""}};var uin=CommonJS.GetQueryString("uin")?CommonJS.GetQueryString("uin"):sessionStorage.getItem("ddz_uin");uin=uin?Math.floor(uin.replace("o","")):false;var TOKEN=null;if(localStorage.user!=undefined&&localStorage.user!="undefined"&&localStorage.user){var localUser=JSON.parse(localStorage.user);for(var key in localUser){if(localUser[key].uin==uin){TOKEN=localUser[key].TOKEN}}}var CommonAPP={ua:navigator.userAgent,MQQBrowser:function(){var c=this.ua.split(" ");var a=false;for(var b=0;b<c.length;b++){if(c[b].indexOf("TBS/")>-1){a=true}else{if(c[b].indexOf("MQQBrowser")>-1){if(parseFloat(c[b].substring(11))>7.1){a=true}}}}return a},MSDK:navigator.userAgent.indexOf("MSDK")>-1?true:false,weixin:navigator.userAgent.toLowerCase().match(/MicroMessenger/i)=="micromessenger"?true:false,android:navigator.userAgent.indexOf("Android")>-1||navigator.userAgent.indexOf("Linux")>-1?true:false,appSchema:"mktv://stream",appApk:"https://api.dasheng.tv:4431/v1/app/download?market=doudizhuzhibojian",iphoneDownUrl:"//itunes.apple.com/cn/app/%E5%A4%A7%E5%9C%A3-%E5%8F%AF%E4%BB%A5%E7%8E%A9%E7%9A%84%E5%B0%8F%E8%A7%86%E9%A2%91/id1327268860?ls=1&mt=8",sjqqDownUrl:"//a.app.qq.com/o/simple.jsp?pkgname=com.appgame.mktv",openApp:function(a){var c=this;var b=new Date();a=a?a:this.appApk;if(CommonAPP.android){if(CommonAPP.weixin){window.location=this.sjqqDownUrl}else{if(CommonAPP.MSDK){window.location=a}else{window.location=c.appSchema;window.setTimeout(function(){var d=new Date();if(d-b<1200){window.location=a}else{window.close()}},33)}}}else{window.location=c.iphoneDownUrl}}};(function(){window.HTML=function(){this._video=null;this.options={poster:v.poster,textTrackDisplay:false,loadingSpinner:true,bigPlayButton:false,controls:true,errorDisplay:true,textTrackSettings:false,preload:"none",controlBar:!CommonAPP.android}};HTML.prototype={buildPlayer:function(a){var b='<a href="./live.html?videoId='+a.chatroom_id+"\" onClick=\"_hmt.push(['_trackEvent', '斗地主直播间', '标题进入', '主直播间 - "+a.title+", 1]);_czc.push(['_trackEvent', '斗地主', '主直播间"+a.title+"', 0, 'play']);\">";if(a.status==1){b+="<b>直播</b>"}else{b+="<b>重播</b>"}b+="<span>"+a.title+"</span></a>";$("#videoTitle").append(b);var c=document.createElement("video");if(!CommonAPP.android){c.setAttribute("webkit-playsinline",true);c.setAttribute("playsinline",true);c.setAttribute("x-webkit-airplay",true)}var d=document.createElement("source");if(a.url.indexOf("m3u8")>0){d.setAttribute("type","application/x-mpegURL")}else{d.setAttribute("type","video/mp4")}d.src=a.url;c.appendChild(d);document.getElementsByClassName("video")[0].appendChild(c);mainVideo=videojs(c,this.options,function e(){if(CommonAPP.android){document.getElementsByTagName("video")[0].setAttribute("controls",true)}this.on("play",function(){_hmt.push(["_trackEvent","斗地主直播间","播放","主直播间 - "+a.title,1]);_czc.push(["_trackEvent","斗地主","主直播间",a.title,0,"play"])});$("button.vjs-fullscreen-control").remove();$(".vjs-control-bar").append('<a href="./live.html?videoId='+a.chatroom_id+"\" onClick=\"_hmt.push(['_trackEvent', '斗地主直播间', '全屏进入', '主直播间 - "+a.title+', 1]);" class="vjs-fullscreen-control"></a>')})},itemHTML:function(c,d,a){var b="";if(d==1){b+=""}else{if(d==2){b+='<li class="shrinkage">'}else{b+="<li>"}}if(c.url.indexOf("qq.html")>-1){b+='<a href="'+c.url+'" class="item">'}else{b+='<a href="./live.html?videoId='+c.chatroom_id+'" class="item">'}if(a==1){b+='<i class="swiper-lazy" data-background="'+c.poster+'">'}else{if(a==2){b+='<i class="lazyload" data-original="'+c.poster+'">'}else{b+='<i style="background-image: url('+c.poster+')">'}}b+="</i>";b+="<p>"+c.title+"</p>";b+="</a>";if(d==1){b+=""}else{b+="</li>"}return b},detailHTML:function(b,e,d,c){var a;if(c&&c!=""){a='<div class="detail detail-match">'}else{a='<div class="detail">'}a+='<img src="'+b+'" alt="">';a+="<h2>"+e+"</h2>";a+="<p>"+d+"</p>";if(c){a+='<a class="matchBtn" href="'+c+'"></a>'}a+="</div>";return a}}})();(function(){window.Dialog=function(){};Dialog.prototype={createDialog:function(b,f,e){var d=document.createElement("div");d.className="dialog d"+b;f.appendChild(d);var g=document.createElement("a");g.className="close closeIt";d.appendChild(g);var f=document.createElement("p");if(b==1){f.innerHTML="在<strong>大圣Live</strong>上预约即可收到节目开播通知还有更多精彩节目等着你！"}else{if(b==2){f.innerHTML="前往<strong>大圣Live</strong>即可领取免费门票，还有更多精彩内容等着你！"}else{if(b==3){}}}if(b!=3){d.appendChild(f)}var c=document.createElement("a");c.className="button b_"+b;c.innerHTML="<b>"+e.btnTitle+"</b>";d.appendChild(c);if(b==3&&CommonAPP.android){var a=document.createElement("div");a.innerHTML="如已安装请直接打开大圣Live";a.style.fontSize="0.18rem";a.style.color="#704428";a.style.textAlign="center";a.style.lineHeight=2;a.style.margin="0.1rem 0 -0.1rem"}c.onclick=function(){_hmt.push(["_trackEvent","斗地主直播间","点击",e.btnTitle,1]);_czc.push(["_trackEvent","斗地主直播间-首页",e.btnTitle,"点击",0,"yscq"])}},openDialog:function(a,c){if(document.getElementsByClassName("mask").length>0){if(document.getElementsByClassName("d"+a).length<=0){this.createDialog(a,document.getElementsByClassName("mask")[0],c)}}else{var b=document.createElement("div");b.className="mask m-"+a;document.getElementsByTagName("body")[0].appendChild(b);this.createDialog(a,b,c)}document.getElementsByClassName("mask")[0].className="mask m-"+a},updateDialog:function(a,b){document.getElementsByClassName("d"+a)[0].getElementsByClassName("button")[0].classList.add(b.btnClass);document.getElementsByClassName("d"+a)[0].getElementsByClassName("button")[0].innerHTML="<b>"+b.btnTitle+"</b>";document.getElementsByClassName("mask")[0].className="mask m-"+a},closeDialog:function(){document.getElementsByClassName("mask")[0].className="mask"}}})();$(document).delegate("a.button","click",function(){CommonAPP.openApp()});if(CommonJS.GetQueryString("Nick")&&CommonJS.GetQueryString("Nick")!="--"&&CommonJS.GetQueryString("Nick")!=null){sessionStorage.setItem("Nick",decodeURI(CommonJS.GetQueryString("Nick")))}if(CommonJS.GetQueryString("HeadURL")&&CommonJS.GetQueryString("HeadURL")!=null){var HeadUrl=CommonJS.GetQueryString("HeadURL");if(HeadUrl.indexOf("wx.qlogo")!=-1){HeadUrl=CommonJS.AppendStr(HeadUrl,"96")}else{if(HeadUrl.indexOf("q.qlogo")!=-1){HeadUrl=CommonJS.AppendStr(HeadUrl,"100")}}sessionStorage.setItem("HeadURL",HeadUrl)}if(CommonJS.GetQueryString("compatibleVersion")&&CommonJS.GetQueryString("compatibleVersion")==1){sessionStorage.setItem("compatibleVersion",CommonJS.GetQueryString("compatibleVersion"))}if(CommonJS.GetQueryString("uin")){sessionStorage.setItem("ddz_uin",CommonJS.GetQueryString("uin"))};