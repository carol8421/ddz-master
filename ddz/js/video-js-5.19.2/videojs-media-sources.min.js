(function(d){var g=0,e=d.MediaSource||d.WebKitMediaSource||{},b=d.URL||{},c,a=/video\/flv(;\s*codecs=["']vp6,aac["'])?$/,f="blob:vjs-media-source/";c=function(){};c.prototype.init=function(){this.listeners=[]};c.prototype.addEventListener=function(h,i){if(!this.listeners[h]){this.listeners[h]=[]}this.listeners[h].unshift(i)};c.prototype.removeEventListener=function(k,l){var j=this.listeners[k],h=j.length;while(h--){if(j[h]===l){return j.splice(h,1)}}};c.prototype.trigger=function(k){var j=this.listeners[k.type]||[],h=j.length;while(h--){j[h](k)}};videojs.MediaSource=function(){var h=this;videojs.MediaSource.prototype.init.call(this);this.sourceBuffers=[];this.readyState="closed";this.listeners={sourceopen:[function(i){h.swfObj=document.getElementById(i.swfId);h.readyState="open";if(h.swfObj){h.swfObj.vjs_load()}}],webkitsourceopen:[function(i){h.trigger({type:"sourceopen"})}]}};videojs.MediaSource.prototype=new c();videojs.MediaSource.BYTES_PER_SECOND_GOAL=4*1024*1024;videojs.MediaSource.TICKS_PER_SECOND=60;videojs.MediaSource.prototype.addSourceBuffer=function(h){var i;if(a.test(h)){i=new videojs.SourceBuffer(this)}else{if(this.nativeSource){i=this.nativeSource.addSourceBuffer.apply(this.nativeSource,arguments)}else{throw new Error("NotSupportedError (Video.js)")}}this.sourceBuffers.push(i);return i};videojs.MediaSource.prototype.endOfStream=function(){this.readyState="ended"};videojs.mediaSources={};videojs.MediaSource.open=function(j,i){var h=videojs.mediaSources[j];if(h){h.trigger({type:"sourceopen",swfId:i})}else{throw new Error("Media Source not found (Video.js)")}};videojs.SourceBuffer=function(l){var j=this,i=[],m=0,k=function(n){d.setTimeout(n,Math.ceil(1000/videojs.MediaSource.TICKS_PER_SECOND))},h=function(){var n,o,p,q,s,r="";if(!i.length){return}if(document.hidden){s=videojs.MediaSource.BYTES_PER_SECOND_GOAL}else{s=Math.ceil(videojs.MediaSource.BYTES_PER_SECOND_GOAL/videojs.MediaSource.TICKS_PER_SECOND)}q=new Uint8Array(Math.min(s,m));o=q.byteLength;while(o){n=i[0].subarray(0,o);q.set(n,q.byteLength-o);if(n.byteLength<i[0].byteLength){i[0]=i[0].subarray(o)}else{i.shift()}o-=n.byteLength}m-=q.byteLength;for(o=0,p=q.byteLength;o<p;o++){r+=String.fromCharCode(q[o])}b64str=d.btoa(r);j.source.swfObj.CallFunction('<invoke name="vjs_appendBuffer"returntype="javascript"><arguments><string>'+b64str+"</string></arguments></invoke>");if(m!==0){k(h)}else{j.updating=false;j.trigger({type:"updateend"});if(j.source.readyState==="ended"){j.source.swfObj.vjs_endOfStream()}}};videojs.SourceBuffer.prototype.init.call(this);this.source=l;this.updating=false;this.appendBuffer=function(o){var n;if(this.updating){n=new Error("SourceBuffer.append() cannot be called while an update is in progress");n.name="InvalidStateError";n.code=11;throw n}if(i.length===0){k(h)}this.updating=true;this.source.readyState="open";this.trigger({type:"update"});i.push(o);m+=o.byteLength};this.abort=function(){i=[];m=0;this.source.swfObj.vjs_abort();if(this.updating){this.updating=false;this.trigger({type:"updateend"})}}};videojs.SourceBuffer.prototype=new c();videojs.URL={createObjectURL:function(i){var h=f+g;g++;videojs.mediaSources[h]=i;return h}};videojs.plugin("mediaSource",function(h){var i=this;i.on("loadstart",function(){var l=i.currentSrc(),k=function(m){j.trigger(m)},j;if(i.techName==="Html5"&&l.indexOf(f)===0){j=videojs.mediaSources[l];if(!j.nativeUrl){j.nativeSource=new e();j.nativeSource.addEventListener("sourceopen",k,false);j.nativeSource.addEventListener("webkitsourceopen",k,false);j.nativeUrl=b.createObjectURL(j.nativeSource)}i.src(j.nativeUrl)}})})})(this);